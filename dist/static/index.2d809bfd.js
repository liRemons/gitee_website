var e=Object.assign;import{r as t,w as o,s as n,t as l,p as a,a as r,g as i,b as c,v as s,x as d,o as u,c as m,d as h,y as p,F as f,e as g,i as T}from"./vendor.60ffb59c.js";const y={setup(){let a=[],r=!1;const{proxy:c}=i(),s=t({html:"",authorList:[],title:""});o((()=>c.$route),((e,t)=>{e.path+e.query.id!==t.path+t.query.id&&(s.title="",a=[],s.authorList=[],e.query.id&&d())}));const d=async()=>{s.html="";let e=await c.$api.HOME.getFileOption(c.$route.query.id);s.html=e,c.$nextTick((()=>{[...document.querySelectorAll("#write a")].filter((e=>e.outerHTML.includes("#"))).forEach((e=>{e.onclick=e=>{let t=s.authorList.findIndex((t=>e.target.parentNode.hash.replace("#","")===t.innerText));return t>=0&&f(t),!1}})),document.querySelectorAll(".md-fences").forEach((e=>{let t=document.createElement("div");t.setAttribute("class","copy_code"),t.onclick=e=>{console.log(e.target.parentElement),function(e){if("object"==typeof e){if(document.body.createTextRange){const t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){const t=window.getSelection(),o=document.createRange();o.selectNodeContents(e),t.removeAllRanges(),t.addRange(o)}document.execCommand("Copy","false",null),window.getSelection().empty()}else{const t=document.createElement("input"),o=document.querySelector("body");t.setAttribute("value",e),t.setAttribute("style","z-index:-1"),o.appendChild(t),t.select(),document.execCommand("copy"),o.removeChild(t)}}(e.target.parentElement),c.$message.success("复制成功")},e.appendChild(t)})),u()}))};n((()=>{let e=document.querySelector(".md");c.$utils.watchScroll(m,500,e),d()}));const u=()=>{let e=[];a=[];let t=document.querySelectorAll(".md .md-header-anchor");t.forEach((o=>{"H2"===o.parentNode.nodeName&&1!=t.length||e.push({outerHTML:o.parentNode.outerHTML.replace(/<a.*?>([\s\S]*)<\/a>/,""),innerText:o.parentNode.innerText,nodeName:o.parentNode.nodeName,offsetTop:o.parentNode.offsetTop,offsetHeight:o.parentNode.offsetTop+o.parentNode.clientHeight,classActive:!1})})),s.authorList=e,c.$nextTick((()=>{let e=c.$route.query.index;e&&(f(e),m())})),a=e},m=()=>{if(r){let e=document.querySelector(".md").scrollTop||document.documentElement.scrollTop,t=a.findIndex((t=>e<t.offsetHeight));h(),t>0&&(s.authorList[t].classActive=!0,p(t)),c.$nextTick((()=>{let e=document.querySelector(".author"),t=document.querySelector(".author .active");Number(t.offsetTop)>window.innerHeight&&(e.scrollTop=Number(t.offsetTop))}))}r=!0},h=()=>{s.authorList.forEach((e=>{e.classActive=!1}))},p=e=>{const{$route:t}=c;c.$router.replace({path:t.path,query:{id:t.query.id,index:e}})},f=e=>{let t;h(),s.authorList[e].classActive=!0,p(e),r=!1,document.querySelectorAll(".md-header-anchor").forEach((o=>{o.parentNode.innerText===s.authorList[e].innerText&&(t=o)})),t&&t.scrollIntoView({behavior:"smooth"})};return e(e({},l(s)),{scrollTo:f,submit:()=>{u(),s.title&&(s.authorList=s.authorList.filter((e=>e.innerText.includes(s.title)))),0==s.authorList.length&&u()},handleClick:e=>{c.$utils.viewImg()}})}},x=T("data-v-07fb1a17");a("data-v-07fb1a17");const b={class:"flex","element-loading-text":"加载页面中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255,255, 255, 0.4)"},v={class:"author","element-loading-text":"加载目录中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(255,255, 255, 0.2)"};r();const L=x(((e,t,o,n,l,a)=>{const r=c("el-button"),i=c("el-input"),T=c("el-affix"),y=c("el-backtop"),L=s("loading");return d((u(),m("div",b,[d(h("div",v,[e.authorList.length?(u(),m(T,{key:0,offset:60},{default:x((()=>[h(i,{size:"mini",onChange:n.submit,modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=t=>e.title=t),placeholder:"请输入标题"},{append:x((()=>[h(r,{onClick:n.submit,icon:"el-icon-search"},null,8,["onClick"])])),_:1},8,["onChange","modelValue"])])),_:1})):p("",!0),(u(!0),m(f,null,g(e.authorList,((e,t)=>(u(),m("div",{class:{active:e.classActive},key:e.outerHTML,onClick:e=>n.scrollTo(t),innerHTML:e.outerHTML},null,10,["onClick","innerHTML"])))),128))],512),[[L,!e.authorList.length]]),h("div",{class:"md",innerHTML:e.html,onClick:t[2]||(t[2]=(...e)=>n.handleClick&&n.handleClick(...e))},null,8,["innerHTML"]),h(y,{target:".md"})],512)),[[L,!e.html]])}));y.render=L,y.__scopeId="data-v-07fb1a17";export default y;
